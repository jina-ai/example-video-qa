jtype: Flow
version: '1'
with:
  protocol: 'http'
  cors: True
  port_expose: '45678'
executors:
  - name: encoder
    uses: jinahub+docker://DPRTextEncoder/v0.2
    uses_with:
      encoder_type: 'question'
      batch_size: 1
    volumes: '.cache/huggingface:/root/.cache/huggingface'
  - name: vec_indexer
    uses: jinahub://SimpleIndexer/v0.4
    uses_with:
      match_args:
        limit: 20
        traversal_ldarray:
          - 'r'
        traversal_rdarray:
          - 'c'
  - name: ranker
    uses: jinahub+docker://DPRReaderRanker/v0.3  # extract the answers from the matches, save the location information
    uses_with:
      num_spans_per_match: 1
  - name: text2frame_converter  # calculate the location based on the text
    uses: Text2Frame
    py_modules:
      - executors.py